<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login/Register with Animated Background</title>
    <link rel="stylesheet" href="css/login.css">
    <script src="js/login.js" defer></script>
	<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
    <div class="area">
        <ul class="circles">
            <li><img src="Images/bulbasar.png" alt="Bulbasaur"></li>
            <li><img src="Images/caterpie.png" alt="Caterpie"></li>
            <li><img src="Images/Gengar.png" alt="Gengar"></li>
            <li><img src="Images/Mudkip.png" alt="Mudkip"></li>
            <li><img src="Images/Pikachu.png" alt="Pikachu"></li>
            <li><img src="Images/Squirtle.png" alt="Squirtle"></li>
            <li><img src="Images/Treko.png" alt="Treecko"></li>
            <li><img src="Images/Zekrom.png" alt="Zekrom"></li>
            <li><img src="Images/Zorak.png" alt="Zoroark"></li>
            <li><img src="Images/Dratini.png" alt="Dratini"></li>
            <li><img src="Images/Snivy.png" alt="Snivy"></li>
            <li><img src="Images/jigglypuff.png" alt="Jigglypuff"></li>
            <li><img src="Images/Snorlax.png" alt="Snorlax"></li>
            <li><img src="Images/HO OH.png" alt="Ho-oh"></li>
            <li><img src="Images/Lugia.png" alt="Lugia"></li>
            <li><img src="Images/Minun.png" alt="Minun"></li>
            <li><img src="Images/Infernape.png" alt="Infernape"></li>
        </ul>
    </div>

    <!-- Login/Signup Form -->
    <div class="container" id="container">
        <!-- Signup Form -->
		<div class="form-container sign-up-container">
			<form id="signup-form">
				<h1 id="CreateAcc">Create Account</h1>
				<label for="signup-username">Username:</label>
				<input type="text" id="signup-username" name="username" placeholder="Username" required aria-label="Username" />

				<label for="signup-email">Email:</label>
				<input type="email" id="signup-email" name="email" placeholder="Email" required aria-label="Email" />
				<span id="signup-email-error" class="error" style="display:none;">Please enter a valid email address.</span>

				<label for="signup-password">Password:</label>
				<input type="password" id="signup-password" name="password" placeholder="Password" required aria-label="Password" minlength="6" />
				<button type="button" onclick="registerUser();">Register</button>
				<div id="message"></div>
			</form>
		</div>
		

        <!-- Login Form -->
        <div class="form-container sign-in-container">
            <form id="login-form" action="/api/users/login" method="POST">
                <h1 id="signIN">Sign in</h1>
                <label for="login-email">Email:</label>
                <input type="email" id="login-email" name="email" placeholder="Email" required aria-label="Email" />
                
                <label for="login-password">Password:</label>
                <input type="password" id="login-password" name="password" placeholder="Password" required aria-label="Password" />
                <a href="#">Forgot your password?</a>
                <button type="button" onclick="loginUser();">Sign In</button>
				<div id="LoginMessage"></div>
            </form>
        </div>

        <!-- Overlay Section -->
        <div class="overlay-container">
            <div class="overlay">
                <div class="overlay-panel overlay-left">
                    <h1>Welcome Back!</h1>
                    <p>To keep connected with us please login with your trainer info</p>
                    <button class="ghost" id="signIn">Sign In</button>
                </div>
                <div class="overlay-panel overlay-right">
                    <h1>Hello, Trainer!</h1>
                    <p>Enter your personal details and start your journey with us</p>
                    <button class="ghost" id="signUp">Sign Up</button>
                </div>
            </div>
        </div>
    </div>

	<script>
    function registerUser() {
    const username = document.getElementById("signup-username").value;
    const email = document.getElementById("signup-email").value;
    const password = document.getElementById("signup-password").value;

    axios.post("http://localhost:3000/users/register", { username, email, password })
	.then(function (response) {
                const messageDiv = document.getElementById('message');
                messageDiv.textContent = response.data.message;
                messageDiv.style.color = 'green'
            })
            .catch(function (error) {
                const messageDiv = document.getElementById('message');
                messageDiv.textContent = error.response.data.message;
                messageDiv.style.color = 'red'
            })
        }

	function loginUser() {
    const email = document.getElementById("login-email").value;
    const password = document.getElementById("login-password").value;

    axios.post("http://localhost:3000/users/login", { email, password })
        .then(function (response) {
            const messageDiv = document.getElementById('LoginMessage');
            messageDiv.textContent = response.data.message;
            messageDiv.style.color = 'green';

            // Store user_id in localStorage
            localStorage.setItem('user_id', response.data.user_id); 

            // Store username in localStorage
            localStorage.setItem('username', response.data.username);

            // Redirect to gameHome.html
            window.location.href = "gameHome.html";
        })
        .catch(function (error) {
            const messageDiv = document.getElementById('LoginMessage');
            messageDiv.textContent = error.response.data.message;
            messageDiv.style.color = 'red';
        });
}


    </script>

</body>
</html>
